---
// PostList component for displaying posts with view count, date, and title
import { getCollection } from "astro:content";
import Link from "../Link.astro";
// import ViewCounterRead from "./ViewCounterRead.astro";

const allPosts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<div class="py-8">
  <h2 class="text-2xl font-medium mb-6 border-b pb-2">All Blog Posts</h2>

  <ul class="space-y-6 list-none">
    {allPosts.map((post) => (
      <li class="post-item border-l-2 pl-4 py-2 transition-all border-secondary-ui hover:border-primary-link bg-primary-ui rounded-r">
        <div class="flex items-center text-sm text-secondary-text mb-1">
          <time datetime={post.data.pubDate.toISOString()} class="font-mono">
            {post.data.pubDate.toLocaleDateString('en-US', {year: 'numeric', month: 'short', day: 'numeric'})}
          </time>
        </div>
        <h3 class="text-lg font-medium mb-1">
          <Link href={`/posts/${post.id}`}>
            {post.data.title || 'Untitled Post'}
          </Link>
        </h3>
        {post.data.description &&
          <p class="text-sm leading-relaxed">{post.data.description}</p>
        }
      </li>
    ))}
  </ul>
</div>

<style>
  .post-item:hover a {
    text-decoration: underline;
  }
</style>