---
// Search Modal Component
import Search from "astro-pagefind/components/Search";
import SearchIcon from "@/icons/svg/SearchIcon.astro";
import CloseIcon from "@/icons/svg/CloseIcon.astro";

const className = {
  button: 'bg-transparent border-none cursor-pointer p-2 rounded-full flex items-center justify-center transition-colors hover:bg-primary-text/5',
}
---

<!-- Search Component with Alpine.js -->
<div x-data="{
  open() { $refs.modal.showModal() },
  close() { $refs.modal.close() },
  checkClose(e) { !this.$refs.content.contains(e.target) && this.close() },
}">
  <!-- Search Icon Button -->
  <button
    @click="open"
    aria-label="Open search"
    class={className.button}
  >
    <SearchIcon />
  </button>

  <!-- Search Modal Dialog -->
  <dialog
    x-ref="modal"
    @click="checkClose"
    @keydown.escape="close"
    class="border-none bg-primary-ui rounded-lg p-0 max-w-2xl w-11/12 shadow-lg backdrop:bg-primary-text/50 backdrop:backdrop-blur-sm mt-16 mx-auto overflow-hidden"
  >
    <div x-ref="content" class="p-5 max-h-[calc(100vh-4rem)] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h2 class="m-0 text-2xl">Search</h2>
        <button
          @click="close"
          aria-label="Close search"
          class={className.button}
        >
          <CloseIcon />
        </button>
      </div>
      <div>
        <Search id="search" uiOptions={{ showImages: false }} />
      </div>
    </div>
  </dialog>
</div>
